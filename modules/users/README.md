# User Template

This is a template for creating new user configurations. Copy this file to `[username].nix` and customize the values.

```nix
{ self
, config
, ...
}:
let
  # User-specific configuration
  username = "USERNAME";          # Change this to the username
  fullName = "FULL NAME";         # Change this to full name
  email = "EMAIL@DOMAIN.COM";     # Change this to email address
  homeDir = "/home/${username}";
in
{
  # Define the user for the system
  users.users.${username} = {
    isNormalUser = true;
    description = fullName;
    extraGroups = [
      "networkmanager"
      "wheel"                     # sudo access
      # Add additional groups as needed:
      # "kvm"                     # KVM virtualization
      # "input"                   # Input devices
      # "disk"                    # Disk management
      # "libvirtd"                # Libvirt virtualization
      # "plugdev"                 # USB devices
      # "qemu-libvirtd"           # QEMU
      # "video"                   # Video devices
      # "adm"                     # System logs
      # "lp"                      # Printing
      # "scanner"                 # Scanner access
    ];
    # Optional: Set initial password hash
    # hashedPassword = "...";
  };

  # Home Manager configuration for the user
  home-manager.users.${username} = {
    home = {
      stateVersion = "24.05";     # Match your NixOS version
      homeDirectory = homeDir;
      username = username;
    };

    nixpkgs = {
      config = {
        allowUnfree = true;       # Allow unfree packages (optional)
        allowBroken = false;
        allowUnsupportedSystem = false;
      };
      overlays = [
        self.overlays.default
      ];
    };

    # User-specific home-manager configurations
    programs.git.settings.user = {
      name = fullName;
      email = email;
    };

    # Optional: User-specific Niri background path
    # This displays a blurred wallpaper in the Niri overview mode
    # The blur is generated by Dank Hooks from DankMaterialShell
    # Requires: https://github.com/kcalvelli/scripts
    # See docs/NIRI_WALLPAPER.md for setup details
    # programs.niri.settings.spawn-at-startup = [
    #   { 
    #     command = [ 
    #       "swaybg" 
    #       "--mode" "stretch" 
    #       "--image" "${homeDir}/.cache/niri/overview-blur.jpg" 
    #     ]; 
    #   }
    # ];
  };

  # Optional: User-specific Samba shares
  # services.samba = {
  #   enable = true;
  #   settings = {
  #     "music" = {
  #       "path" = "${homeDir}/Music";
  #       "writable" = "yes";
  #       "guest ok" = "no";
  #     };
  #     "pictures" = {
  #       "path" = "${homeDir}/Pictures";
  #       "writable" = "yes";
  #       "guest ok" = "no";
  #     };
  #   };
  # };

  # Optional: Trust this user with nix operations
  # nix.settings = {
  #   trusted-users = [ username ];
  # };
}
```

## What to Customize

1. **username**: The system username (lowercase, no spaces)
2. **fullName**: Full display name
3. **email**: Email address for git commits
4. **extraGroups**: System groups for permissions
5. **stateVersion**: Match your NixOS version
6. **Optional configurations**: Uncomment and customize as needed

## Steps to Add a New User

### During Installation

The automated installer (`scripts/install-axios.sh`) creates your first user account automatically. You'll be prompted for:
- Username
- Full name  
- Email address (optional, used for git)

Your user will have sudo access and will be configured with the features you selected during installation.

### After Installation

To add additional users:

1. Copy this template to `modules/users/[username].nix`
2. Replace `USERNAME`, `FULL NAME`, and `EMAIL@DOMAIN.COM` with actual values
3. Customize groups and optional configurations
4. The user will be automatically discovered and imported
5. Rebuild your system: `sudo nixos-rebuild switch --flake .`

## User-Specific vs Shared Configuration

**Put in user file (`modules/users/[username].nix`):**
- Username, full name, email
- User groups and permissions
- User-specific paths (home directory, samba shares)
- User-specific git config
- User-specific background images
- Trusted user settings

**Put in home-manager shared config (`home/`):**
- Application configurations
- Shell configurations
- Desktop environment settings
- Theme preferences
- Package lists

The user file should contain only user-identifying information and user-specific overrides. All general application and environment configurations should remain in the shared home-manager modules.
